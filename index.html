<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LivingWell Centre – Client Intake & Consent Form</title>
  <style>
    :root{
      --accent:#568273;
      --accent-dark:#46695e;
      --bg:#f4f4f4;
      --card:#fff;
      --muted:#888;
      --error:#b00020;
    }
    html,body{height:100%}
    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color: #222;
      background-color: var(--bg);
      margin: 0;
      padding: 0 12px;
      -webkit-font-smoothing:antialiased;
    }
    .container {
      max-width: 860px;
      margin: 30px auto;
      background-color: var(--card);
      padding: 28px;
      border-radius: 10px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    }
    .header {text-align:center;margin-bottom:18px}
    .header img{
      width:100%;
      height:auto;
      max-height:180px;
      object-fit:cover;
      margin-bottom:8px;
      display:block;
    }
    h1{color:var(--accent);margin:0 0 6px;font-size:22px}
    p.intro{font-size:15px;line-height:1.6;margin:8px 0 18px}
    fieldset{
      border:1px solid #e6e6e6;border-radius:8px;margin-bottom:20px;padding:16px;background:#fbfbfb
    }
    legend{font-weight:700;color:var(--accent);padding:0 6px}
    .form-row{display:flex;gap:12px;flex-wrap:wrap}
    label{display:block;font-weight:600;margin:8px 0 6px}
    input[type="text"],input[type="email"],input[type="tel"],input[type="date"],textarea,select{
      width:100%;padding:9px;border:1px solid #cfcfcf;border-radius:6px;font:inherit;box-sizing:border-box
    }
    textarea{min-height:88px;resize:vertical}
    .small{width:140px}
    .checkbox-group,label.inline{font-weight:400;display:inline-flex;align-items:center;gap:6px;margin-right:12px}
    .submit-btn{
      display:inline-flex;align-items:center;gap:10px;background:var(--accent);color:#fff;padding:12px 20px;border-radius:8px;border:0;cursor:pointer;font-size:16px
    }
    .submit-btn[disabled]{opacity:.6;cursor:not-allowed}
    footer{text-align:center;font-size:12px;color:var(--muted);margin-top:22px;padding-top:12px;border-top:1px solid #eee}
    .visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}
    .note{font-size:13px;color:#444;margin:6px 0}
    #confirmation{display:none;color:green;text-align:center;margin-bottom:12px}
    .error{color:var(--error);font-size:13px}
    @media(min-width:700px){.two{flex:1 1 48%}.three{flex:1 1 30%}}
    @media(max-width:600px){
      body {padding:0 10px;}
      .submit-btn {width:100%; justify-content:center;}
      .checkbox-group label.inline,
      [role="radiogroup"] label.inline {width:100%; margin-bottom:8px;}
    }
    .checkbox-group, [role="radiogroup"] {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }
    .checkbox-group label.inline,
    [role="radiogroup"] label.inline {
      flex: 1 1 100%;
      min-width: 120px;
    }
  </style>
</head>
<body>
  <main class="container" role="main">
    <div class="header">
      <img src="https://i.imgur.com/xY4N3U3.png" alt="LivingWell header image">
      <h1>Client Intake & Consent Form</h1>
      <p class="note">LivingWell Centre – Chaussée d'Etterbeek 64, 1040 Bruxelles – contact@livingwell.be</p>
    </div>

    <p class="intro">
      LivingWell is a non-profit holistic wellness centre dedicated to providing safe, respectful, and inclusive care.
      The information you share helps us tailor sessions to your needs and ensure your well-being.
      Please complete this form before your first appointment.
    </p>

    <p id="confirmation" role="status" aria-live="polite">Thank you! Your form has been successfully submitted.</p>

    <form id="clientForm" action="" method="POST" novalidate>
      <!-- 1. Personal Information -->
      <fieldset>
        <legend>1. Personal Information</legend>
        <div class="form-row">
          <div class="two">
            <label for="first_name">First name <span class="error">*</span></label>
            <input id="first_name" name="first_name" type="text" required autocomplete="given-name" placeholder="First">
          </div>
          <div class="two">
            <label for="last_name">Last name <span class="error">*</span></label>
            <input id="last_name" name="last_name" type="text" required autocomplete="family-name" placeholder="Last">
          </div>
          <div class="small">
            <label for="dob">Date of birth <span class="error">*</span></label>
            <input id="dob" name="dob" type="date" required max="">
          </div>
        </div>

        <label for="address">Address</label>
        <input id="address" name="address" type="text">

        <div class="form-row">
          <div class="three">
            <label for="postal_code">Postal code</label>
            <input id="postal_code" name="postal_code" type="text" pattern="[A-Za-z0-9\s\-]{2,10}">
          </div>
          <div class="three">
            <label for="city">City</label>
            <input id="city" name="city" type="text">
          </div>
          <div class="three">
            <label for="phone">Phone number</label>
            <input id="phone" name="phone" type="tel" placeholder="+32 123 456 789">
          </div>
        </div>

        <label for="email">Email address <span class="error">*</span></label>
        <input id="email" name="email" type="email" required placeholder="name@example.com">

        <label>Preferred contact method (select at least one)</label>
        <div class="checkbox-group">
          <label class="inline"><input type="checkbox" name="contact_method" value="Email"> Email</label>
          <label class="inline"><input type="checkbox" name="contact_method" value="Phone"> Phone</label>
          <label class="inline"><input type="checkbox" name="contact_method" value="SMS"> SMS</label>
          <label class="inline"><input type="checkbox" name="contact_method" value="WhatsApp"> WhatsApp</label>
        </div>
      </fieldset>

      <!-- 2. Service Selection -->
      <fieldset>
        <legend>2. Service Selection</legend>
        <div class="checkbox-group">
          <label class="inline"><input type="checkbox" name="service" value="Localised Chair Massage"> Localised Chair Massage</label>
          <label class="inline"><input type="checkbox" name="service" value="Localised Massage with Oils"> Localised Massage with Oils</label>
          <label class="inline"><input type="checkbox" name="service" value="Aromatherapy Massage"> Aromatherapy Massage</label>
          <label class="inline"><input type="checkbox" name="service" value="Maderotherapy Massage"> Maderotherapy Massage</label>
          <label class="inline"><input type="checkbox" name="service" value="Free 10-minute Quick Relief Massage"> Free 10-minute Quick Relief Massage</label>
        </div>
      </fieldset>

      <!-- 3. Consent -->
      <fieldset>
        <legend>3. Consent & Acknowledgement</legend>
        <p class="note">
          <strong>Nature of Service:</strong> I understand services are non-medical and complementary.<br>
          <strong>Privacy & GDPR:</strong> Data stored securely for 7 years. Requests for access, correction, or deletion can be sent to contact@livingwell.be.<br>
          <strong>Touch Consent:</strong> I understand massage involves physical touch.<br>
          <strong>Liability Waiver:</strong> LivingWell is not responsible for adverse reactions if information is incomplete.
        </p>
        <label class="inline">
          <input type="checkbox" id="gdpr_consent" name="gdpr_consent" required>
          I consent to the processing of my personal data in accordance with the privacy policy. <span class="error">*</span>
        </label>
      </fieldset>

      <!-- 4. House Rules -->
      <fieldset>
        <legend>4. House Rules</legend>
        <p class="note">
          1. <strong>Purpose of Services:</strong> All services are non-medical.<br>
          2. <strong>Registration & Identification:</strong> Clients must register upon arrival. Presenting a valid ID may be required.<br>
          5. <strong>Smoking/Vaping:</strong> Strictly prohibited within the premises.<br>
          6. <strong>Alcohol/Substances:</strong> Consumption of alcohol or substances that may impair judgement is not permitted before or during treatments. We reserve the right to deny access to the centre and to services if the client is under the influence.<br>
          7. <strong>Health Conditions:</strong> Notify the therapist of any and all health related conditions that are relevant before receiving your massage.<br>
          8. <strong>Behavior:</strong> Respectful behavior is expected at all times. Aggressive or inappropriate conduct may result in immediate termination of services without refund and denial of access to our premises.<br>
          9. <strong>Liability:</strong> LivingWell is not liable for accidents or injuries that occur on the premises.<br>
          10. <strong>Photography:</strong> Photography and recording are not permitted during treatments to ensure privacy.<br>
          11. <strong>Cancellations:</strong> Cancel at least 24 hours in advance. Late arrivals may reduce session length without refund.<br>
          12. <strong>Payment:</strong> Payment is due in advance or latest at the time of service as a general rule. Accepted methods include cash and electronic payment.<br>
          13. <strong>Safety:</strong> Notify the therapist immediately of any discomfort.<br>
          14. <strong>Governing Law:</strong> This agreement is governed by Belgian law. The courts of Brussels have exclusive jurisdiction.
        </p>
      </fieldset>

      <!-- 5. Marketing Consent -->
      <fieldset>
        <legend>5. Marketing Consent</legend>
        <div role="radiogroup">
          <label class="inline"><input type="radio" name="marketing" value="Agree"> I agree to receive LivingWell updates</label>
          <label class="inline"><input type="radio" name="marketing" value="Disagree"> I do not wish to receive marketing communications</label>
        </div>
      </fieldset>

      <p class="note">
        By submitting this form, you agree to Livingwell's terms and conditions.
      </p>

      <div style="display:flex;gap:12px;align-items:center">
        <button type="submit" id="submitBtn" class="submit-btn">Submit</button>
        <div id="formError" class="error" role="alert" style="display:none"></div>
      </div>
    </form>

    <footer>
      LivingWell Centre – Chaussée d'Etterbeek 64, 1040 Bruxelles – contact@livingwell.be<br>
      Records retained for 7 years in accordance with GDPR.
    </footer>
  </main>

  <script>
    (function(){
      // Only place to set your Apps Script Web App URL
      const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxmsq-xBPk8FCnGLPp4PPmqIE9kv30DWqKnlylegQbl4aCUssi3jubFPp3E98hToJOj/exec';

      const form = document.getElementById('clientForm');
      const submitBtn = document.getElementById('submitBtn');
      const confirmation = document.getElementById('confirmation');
      const formError = document.getElementById('formError');

      // Set max date for date inputs
      const today = new Date().toISOString().split('T')[0];
      document.querySelectorAll('input[type="date"]').forEach(inp => inp.max = today);

      function showError(msg){
        formError.textContent = msg;
        formError.style.display = msg ? 'block' : 'none';
      }

      function customValidate(){
        const gdpr = document.getElementById('gdpr_consent');
        if(!gdpr.checked){
          showError('You must consent to the processing of personal data.');
          return false;
        }
        const methods = [...document.querySelectorAll('input[name="contact_method"]')];
        if(!methods.some(c => c.checked)){
          showError('Please select at least one preferred contact method.');
          return false;
        }
        const marketing = [...document.querySelectorAll('input[name="marketing"]')];
        if(!marketing.some(r => r.checked)){
          showError('Please select your marketing preference.');
          return false;
        }
        showError('');
        return true;
      }

      function ensureIframe(){
        let iframe = document.getElementById('submission_iframe');
        if(!iframe){
          iframe = document.createElement('iframe');
          iframe.style.display = 'none';
          iframe.id = 'submission_iframe';
          iframe.name = 'submission_iframe';
          document.body.appendChild(iframe);
        }
        return iframe;
      }

      function fallbackSubmit(){
        const iframe = ensureIframe();
        form.target = iframe.name;
        form.action = WEB_APP_URL;
        form.submit();
        confirmation.style.display = 'block';
        confirmation.textContent = 'Form submitted (fallback mode).';
        form.reset();
        setTimeout(()=> confirmation.style.display='none',8000);
        form.removeAttribute('target');
        form.removeAttribute('action');
      }

      form.addEventListener('submit', function(e){
        e.preventDefault();
        if(!form.checkValidity()){form.reportValidity();return;}
        if(!customValidate()) return;

        submitBtn.disabled = true;
        submitBtn.textContent = 'Sending…';

        const formData = new FormData(form);

        fetch(WEB_APP_URL,{method:'POST',body:formData})
        .then(res => {
          if(!res.ok) throw new Error('Server error');
          const ct=res.headers.get('content-type')||'';
          return ct.includes('json') ? res.json() : {status:'success'};
        })
        .then(json=>{
          if(json.status==='success'){
            confirmation.style.display='block';
            confirmation.textContent='Thank you! Your form has been successfully submitted.';
            form.reset();
            setTimeout(()=>confirmation.style.display='none',8000);
          } else {
            throw new Error(json.message||'Unexpected response');
          }
        })
        .catch(()=> fallbackSubmit())
        .finally(()=>{
          submitBtn.disabled=false;
          submitBtn.textContent='Submit';
        });
      });
    })();
  </script>
</body>
</html>
